/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
plugins {
    id "java-library"
    id "jacoco"
    id 'org.sonarqube' version '3.0'
    id "dev.clojurephant.clojure" version "0.5.0" apply false
    id 'com.google.cloud.tools.jib' version '2.5.1' apply false
    id "io.spring.dependency-management" version "1.0.10.RELEASE" apply false
}

ext {
    h2Version = "1.4.200"
    owlVersion = "5.1.14"
    junitJupiterVersion = "5.6.2"
    jenaVersion = "3.14.0"
    slf4jVersion = "1.7.30"
    caffeineVersion = "2.8.5"
    checkerVersion = "3.3.0"
    commonsLangVersion = "3.10"
    esriVersion = '2.2.3'
    geotoolsVersion = "23.1"
    metricsVersion = "4.1.5"
    postgresVersion = '42.2.14'
    guiceVersion = "4.2.3"
    mockitoVersion = '3.3.3'
}

allprojects {
    group = "com.nickrobison.trestle"
    version = "0.9.2-SNAPSHOT"
    repositories {
        // This needs to go first, in order to get the jai core jars, which jcenter doesn't have.
        maven { url "https://repo.osgeo.org/repository/release/" }
        jcenter()
        maven { url "https://clojars.org/repo" }
        maven { url "https://jitpack.io" }
    }
}

subprojects {
    apply plugin: 'java-library'
    apply plugin: 'jacoco'
    apply plugin: "io.spring.dependency-management"

    dependencyManagement {
        imports {
            mavenBom "com.fasterxml.jackson:jackson-bom:2.11.2"
            mavenBom "org.eclipse.rdf4j:rdf4j-bom:3.2.2"
        }
        dependencies {
            dependency group: 'commons-io', name: 'commons-io', version: '2.8.0'
            dependency group: 'me.tongfei', name: 'progressbar', version: '0.8.1'
            dependency group: 'org.locationtech.jts', name: 'jts-core', version: "1.16.1"
            dependency group: 'com.esri.geometry', name: 'esri-geometry-api', version: '2.2.3'
            dependency group: 'com.google.guava', name: 'guava', version: "29.0-jre"
            dependency group: 'com.google.inject', name: 'guice', version: guiceVersion
        }
    }

    jacocoTestReport {
        reports {
            xml.enabled = true
        }
    }

    dependencies {
        // Dependencies
        compileOnly group: 'org.checkerframework', name: 'checker', version: checkerVersion
        implementation group: 'net.sourceforge.owlapi', name: 'owlapi-api', version: owlVersion
        implementation group: 'org.slf4j', name: 'slf4j-api', version: slf4jVersion
        implementation group: "com.typesafe", name: "config", version: "1.4.0"
        testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: junitJupiterVersion
        testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-params', version: junitJupiterVersion
        testRuntimeOnly group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: junitJupiterVersion
    }
    java {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
        withJavadocJar()
        withSourcesJar()
    }

    tasks.withType(JavaCompile) {
        options.compilerArgs << '-parameters'
    }

    test {
        useJUnitPlatform()
    }
}